<!doctype html>
<html>
<head>
  <meta charset="UTF-8">
  <meta
    content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no"
    id="viewport"
    name="viewport"
  />

  <link href="./index.css" rel="stylesheet">


</head>
<body>
  <!-- 禁止縮放 -->  
  <script>
    document.addEventListener(
      "touchmove",
      function (event) {
        if (event.scale !== 1) {
          event.preventDefault();
        }
      },
      { passive: false }
    );
  </script>

  <script  type="importmap">
    {
      "imports": {
        "three": "./build/three.module.js"
      }
    }
  </script>

<!-- 頭像logo -->
<div style="position: fixed; left: 0; top: 0; z-index: 10; ">
  <img src="./logo.png" width="50px" height="50px" style="border-radius: 50%; margin: 10px;" id="openLogoModal" />
</div>

<div id='three'> </div>
<!-- <button type="button" id="begin" style="border: none; background: none; margin-top: 20px; background: black; width: 50%; color: white; border-radius: 5px; font-size: 14px; padding: 5px;" >重玩</button> -->

<!-- taiwindcss -->
<div class="hidden" id="copyLink">
 <div class="relative z-10 " aria-labelledby="modal-title" role="dialog" aria-modal="true">
  <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"></div>
  <div class="fixed inset-0 z-10 overflow-y-auto" >
    <div class="flex min-h-full items-center justify-center p-4 text-center sm:items-center sm:p-0">
      <div style="background: green; color: white;" class="relative transform overflow-hidden rounded-lg bg-white px-4 pt-5 pb-4 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-sm sm:p-6">
        <div  >
          <h1 style="text-align: center; font-size: 20px; font-size: 24px;">地域科技</h1>
          <div class="mx-auto flex h-12 w-12 items-center justify-center rounded-full bg-green-100 mt-4">
            <img src="./logo.png" width="50px" height="50px" style="border-radius: 50%;" alt="" />
          </div>
          <div class="mt-3 text-center sm:mt-5 p-2">
            <h3 class="text-lg font-medium leading-6 " id="modal-title">遊戲提示</h3>
            <div class="mt-2">
              <p class="text-sm">請使用手機Chrome瀏覽器或手機原生瀏覽器打開，可複製網址並於瀏覽器中開啟</p>
            </div>
          </div>
        </div>
        <div style="display: -webkit-box; display: -webkit-flex;  display: flex; justify-content: center; align-items: center; flex-direction: column;">
          <input type="text" size="30" style=" width: 100%; border-radius: 4px; border: none; border-color: rgb(212, 203, 203); padding: 5px; outline: none; color: black;" id="copyUrl" value="">
          <button type="button" style="border: none; background: none; margin-top: 20px; background: black; width: 50%; color: white; border-radius: 5px; font-size: 14px; padding: 5px;" onclick="document.getElementById('copyUrl').select();document.execCommand('Copy')">複製鏈接</button>
        </div>
      </div>
    </div>
  </div>
</div>
</div> 

  <!-- 複製鏈接 -->
  <!-- <div id="copyLinks" style="display: none; position: fixed;  top: 0; right: 0; left: 0; bottom: 0; ">
    <div  style=" position: absolute; top: 0;  left: 0; right: 0;  bottom: 0; display: -webkit-box; display: -webkit-flex; display: flex;justify-content: center; align-items: center; z-index:10000; ">
      <div style="width:300px; background: green; color: white; border-radius: 10px; border: 1px solid #666;">
        <div style=" padding: 10px;">
          <h1 style="text-align: center; font-size: 20px; font-size: 24px;">地域科技</h1>
          <div style="display: -webkit-box; display: -webkit-flex; display: flex; justify-content: center; padding-top: 20px;">
            <img src="./logo.png" width="50px" height="50px" style="border-radius: 50%;" />
          </div>
          <h1 style="text-align: center; font-size: 20px;">遊戲提示</h1>
          <p style="text-align: center; line-height: 20px; font-size: 16px;">請使用手機Chrome瀏覽器或手機原生瀏覽器打開，可複製網址並於瀏覽器中開啟</p>
        
          <div style="display: -webkit-box; display: -webkit-flex;  display: flex; justify-content: center; align-items: center; flex-direction: column;">
            <input type="text" size="30" style=" width: 100%; border-radius: 4px; border: none; border-color: rgb(212, 203, 203); padding: 5px; outline: none; color: black;" id="copyUrl" value="">
            <button type="button" style="border: none; background: none; margin-top: 20px; background: black; width: 50%; color: white; border-radius: 5px; font-size: 14px; padding: 5px;" onclick="copyUrl.select();document.execCommand('Copy')">複製鏈接</button>
          </div>
        </div>
      </div>
    </div>
  </div> -->

<!-- This example requires Tailwind CSS v2.0+ -->
<!-- <div class="relative z-200" aria-labelledby="modal-title" role="dialog" aria-modal="true">
  <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"></div>
  <div class="fixed inset-0 z-10 overflow-y-auto">
    <div class="flex min-h-full items-center justify-center p-4 text-center sm:items-center sm:p-0">
      <div class="relative transform overflow-hidden rounded-lg bg-white px-4 pt-5 pb-4 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-sm sm:p-6">
        <div>
          <div class="mx-auto flex h-12 w-12 items-center justify-center rounded-full bg-green-100">
            <svg class="h-6 w-6 text-green-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5" />
            </svg>
          </div>
          <div class="mt-3 text-center sm:mt-5">
            <h3 class="text-lg font-medium leading-6 text-gray-900" id="modal-title">Payment successful</h3>
            <div class="mt-2">
              <p class="text-sm text-gray-500">Lorem ipsum dolor sit amet consectetur adipisicing elit. Consequatur amet labore.</p>
            </div>
          </div>
        </div>
        <div class="mt-5 sm:mt-6">
          <button type="button" class="inline-flex w-full justify-center rounded-md border border-transparent bg-indigo-600 px-4 py-2 text-base font-medium text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 sm:text-sm">Go back to dashboard</button>
        </div>
      </div>
    </div>
  </div>
</div> -->

<script src="https://lib.sinaapp.com/js/jquery/2.0.2/jquery-2.0.2.min.js"></script>

<script type="module">
  import * as THREE from "./build/three.module.js";
  import { GLTFLoader } from './js/loaders/GLTFLoader.js';
  var controls;

  const mouse = new THREE.Vector2();
  const raycaster = new THREE.Raycaster();//3d世界鼠標選中物體獲取器

  var scene = new THREE.Scene();//构件一个场景
  
  var camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);//定义一个透视相机
  
  var renderer = new THREE.WebGLRenderer();//渲染器

  //给场景添加光源(会影响兔兔颜色)
  var light= new THREE.PointLight(0xffffff);
  light.position.set(0,50000,0);
  scene.add(light);  

  // 自然光(会影响兔兔颜色)
  var ambientLight = new THREE.AmbientLight( 0x666666 );
  scene.add( ambientLight );

  // controls = new OrbitControls(camera, renderer.domElement);
  // controls.target.set(0, 0, 0);
  // controls.update();
  
  renderer.setSize(window.innerWidth, window.innerHeight);// 设置渲染器的大小为窗口的内宽度，也就是内容区的宽度
  
  document.body.appendChild(renderer.domElement);//domElement元素，表示渲染器中的画布，所有的渲染都是画在domElement上的

  const geometry = new THREE.BoxGeometry( 10, 10, 10 );
  console.log(new THREE.TextureLoader())

  new THREE.TextureLoader().load('rabbit.jpg', function ( texture ) {

    texture.wrapS = texture.wrapT = THREE.RepeatWrapping;
      texture.anisotropy = renderer.capabilities.getMaxAnisotropy();
      const material = new THREE.MeshBasicMaterial( { map: texture } );
      mesh = new THREE.Mesh( geometry, material );
      scene.add( mesh );
      render();
  })

  function render() {
      renderer.render( scene, camera );
  }

  // var geometry = new THREE.CubeGeometry(1,1,1);//THREE.CubeGeometry是一个几何体，有3个参数：width：立方体x轴的长度，height：立方体y轴的长度，depth：立方体z轴的深度
  // var material = new THREE.MeshBasicMaterial({color: 0x00ff00});
  // var cube = new THREE.Mesh(geometry, material); 
  // scene.add(cube);
  // camera.position.z = 5;
  // function render() {//实时渲染，不停循环
  //     requestAnimationFrame(render);
  //     cube.rotation.x += 0.1;
  //     cube.rotation.y += 0.1;
  //     renderer.render(scene, camera);//场景 相机
  // }
  // render();
  renderer.domElement.addEventListener('click', onClick, false);

  // 加载模型
  const loader = new GLTFLoader();
  loader.load('Voxel_RabbitB.glb', function (gltf) {
        // 设置模型缩放比例
        gltf.scene.scale.set(20,20,20);
        gltf.scene.position.set(0,0,0)
        scene.add(gltf.scene);
  })

  $( "#openLogoModal" ).click(function() {
    $('#modals').css('display','block')
  });
  
  $( "#closeModals" ).click(function() {
    $('#modals').css('display','none')
  });

  function onClick( event ) {
        event.preventDefault();
        mouse.x = ( event.clientX / window.innerWidth ) * 2 - 1;
        mouse.y = - ( event.clientY / window.innerHeight ) * 2 + 1;

        // 获取鼠标点击的3D模型
        raycaster.setFromCamera( mouse, camera );
        var intersects = raycaster.intersectObjects( scene.children, true );
    
        if ( intersects.length > 0 ) {
             // 點擊到3D內容
            const object = intersects[0].object;
            $('#modals').css('display','block')
        }
    }
</script>
<script type="module">
import { detect } from "./js/utils"

const browser = {
      // 版本信息 
      versions: function () {
          var u = navigator.userAgent
          var app = navigator.appVersion;
          return {         //移动终端浏览器版本信息
            trident: u.indexOf('Trident') > -1, //IE内核
            presto: u.indexOf('Presto') > -1, //opera内核
            webKit: u.indexOf('AppleWebKit') > -1, //苹果、谷歌内核
            gecko: u.indexOf('Gecko') > -1 && u.indexOf('KHTML') == -1, //火狐内核
            mobile: !!u.match(/AppleWebKit.*Mobile.*/), //是否为移动终端
            ios: !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/), //ios终端
            android: u.indexOf('Android') > -1 || u.indexOf('Linux') > -1, //android终端或uc浏览器
            iPhone: u.indexOf('iPhone') > -1, //是否为iPhone或者QQHD浏览器
            iPad: u.indexOf('iPad') > -1, //是否iPad
            webApp: u.indexOf('Safari') == -1, //是否web应该程序，没有头部与底部  
          };
        }(),
      os:function() { 
          var ua = navigator.userAgent, 
          isWindowsPhone = /(?:Windows Phone)/.test(ua), 
          isSymbian = /(?:SymbianOS)/.test(ua) || isWindowsPhone,  
          isAndroid = /(?:Android)/.test(ua),  
          isFireFox = /(?:Firefox)/.test(ua),  
          isChromeSafari = /(?:Chrome|CriOS)/.test(ua)||/Safari/.test(ua), 
          isTablet = /(?:iPad|PlayBook)/.test(ua) || (isAndroid && !/(?:Mobile)/.test(ua)) || (isFireFox && /(?:Tablet)/.test(ua)), 
          isPhone = /(?:iPhone)/.test(ua) && !isTablet, 
          isPc = !isPhone && !isAndroid && !isSymbian
          return { 
            isTablet: isTablet, 
            isPhone: isPhone, 
            isAndroid : isAndroid, 
            isPc : isPc 
          }; 
        }(),
        language: (navigator.browserLanguage || navigator.language).toLowerCase(),
        // 打開對象
        openObject:function(){
          var ua = navigator.userAgent
          var u = navigator.userAgent.toLowerCase();//获取判断用的对象
          return {
              weixin:u.match(/MicroMessenger/i) == "micromessenger",
              qq:u.match(/QQ/i) == "qq",
              weibo:u.match(/WeiBo/i) == "weibo",
              alipay:/alipay/ig.test(u) ,
              dingtalk:u.indexOf('dingtalk') !== -1,
              chrome:u.indexOf("Chrome") > -1,
              isChrome : /(?:Chrome|CriOS)/.test(ua), 
              isSafari:/Safari/.test(ua),//蘋果內置瀏覽器  百度
              baidui:u.indexOf("baidu") > 0,
              ios :/iphone|ipod|ipad/.test(u)
          }
        }(),
   }


    // ios history.go(-1)回退页面无效处理
    window.addEventListener('pageshow',function(e){
      $('#copyUrl').attr('value',window.location.origin)//可複製的網址
      // 通过persisted属性判断是否存在 BF Cache
      if(e.persisted){
        location.reload();
      }
      // 移動端
      if(/Android|Adr|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){
          //非ios處理  chrome  safari weixin
          if(browser.versions.mobile&&!browser.versions.ios){
              if(browser.openObject.weixin){
                // alert("點擊右上角三個點，在下方選擇“在瀏覽器打開”，選擇chrome瀏覽器打開")
              } else  if(browser.openObject.dingtalk||browser.openObject.alipay||browser.openObject.qq||browser.openObject.baidui){
                $('#copyLink').css('display','block')
              }
          }
      }else{
        // pc端
          // $('#copyLink').css('display','block')
        }
    });
	</script>

  <script>
    $("#begin").click(function() {
      window.loader();
       alert(12)
    });
  
  </script>

</body>
</html>